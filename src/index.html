<!DOCTYPE html>
<html dir="ltr" lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0">
  <title>Stencil Component Starter</title>
  <script src="/build/kwsweather.js"></script>

  <script>
    class ManualTemperature extends HTMLElement {
      constructor() {
        super();
        let shadow = this.attachShadow({mode: 'open'});
        shadow.appendChild(document.createElement('span'));
      }

      connectedCallback() {
        updateTemperature(this);
      }
    }

    function updateTemperature(elem) {
      const shadow = elem.shadowRoot;
      const childNodes = shadow.childNodes;
      childNodes.forEach(element => {
        if (element.nodeName === 'SPAN') {
          const s = elem.getAttribute('scale');
          const t = elem.getAttribute('temperature');
          element.textContent = formattedTemperature(t, s);
        }
      });
    }

    function formattedTemperature(temperature, scale) {
      const t = scale === 'F' ? temperature * 9 / 5 - 459.67 : temperature - 273.15;
      const s = scale === 'F' ? '℉' : '℃';
      return (temperature || '') && (t.toFixed(0) + ' ' + s);
    }

    customElements.define('manual-temperature', ManualTemperature);
  </script>

</head>

<body>
  <h1>Weather Widgets</h1>

  <div class="sample">
    <h2>Temperature</h2>
    <!-- <div>
      <manual-temperature temperature="299" scale="C"></manual-temperature>
    </div> -->
    <div>
      <kws-temperature temperature="273.15" scale="C"></kws-temperature>
    </div>
    <div>
      <kws-temperature temperature="273.15" scale="F"></kws-temperature>
    </div>
    <div>
      <kws-temperature temperature="290.15" scale="C"></kws-temperature>
    </div>
    <div>
      <kws-temperature temperature="290.15" scale="F"></kws-temperature>
    </div>
    <div>
      <kws-temperature temperature="373.15" scale="C"></kws-temperature>
    </div>
    <div>
      <kws-temperature temperature="373.15" scale="F"></kws-temperature>
    </div>
  </div>

</body>

</html>
